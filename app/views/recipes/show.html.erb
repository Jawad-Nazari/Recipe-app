<div class="container mt-5">
  <div class="row">
    <div class="col-md-8 offset-md-2">
      <div class="card">
        <div class="card-body">
          <h2 class="card-title"><%= @recipe.name %></h2>
          <div class="row">
            <div class="col-md-6">
              <p class="card-text"><strong>Description:</strong> <%= @recipe.description %></p>
              <p class="card-text"><strong>Prep Time:</strong> <%= @recipe.preparation_time %> minutes</p>
              <p class="card-text"><strong>Cooking Time:</strong> <%= @recipe.cooking_time %> minutes</p>
            </div>
            <div class="col-md-6 text-md-right">
              <p class="card-text mr-5"><strong>Public:</strong> <%= @recipe.public ? "Yes" : "No" %></p>
            </div>
          </div>
          <div class="d-flex justify-content-between mb-2">
          
           <%= link_to "General Shopping List", shopping_lists_path(recipe_id: @recipe.id),  class: "btn btn-success mt-2" %>
            <%= link_to "Add Ingredients", new_recipe_recipe_food_path(@recipe), class: "btn btn-primary" %>
           
          </div>
          <h4 class="mt-4">Ingredients</h4>
          <% if @food_recipe.any? %>
            <table class="table table-bordered">
              <thead class="thead-light">
                <tr>
                  <th scope="col">Food</th>
                  <th scope="col">Quantity</th>
                  <th scope="col">Price</th>
                  <th scope="col">Actions</th>
                </tr>
              </thead>
              <tbody>
                <% @food_recipe.each do |recipe_food| %>
                  <tr>
                    <td><%= recipe_food.food.name %></td>
                    <td><%= recipe_food.quantity %></td>
                    <td><%= recipe_food.price %></td>
                    <td class="d-flex">
                      <%= link_to "Modify", edit_recipe_recipe_food_path(@recipe, recipe_food), class: "btn btn-warning btn-sm mr-1" %>
                      <%= form_with model: recipe_food, url: recipe_recipe_food_path(@recipe, recipe_food), method: :delete, local: true, data: { confirm: "Are you sure you want to delete this ingredient?" } do |f| %>
                        <%= f.submit "Remove", class: "btn btn-danger btn-sm" %>
                      <% end %>
                    </td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          <% else %>
            <p>No ingredients added yet.</p>
          <% end %>

          <div class="d-flex justify-content-between align-items-center mt-4">
            <%= link_to "Back to Recipes", recipes_path, class: "btn btn-secondary" %>
            <%= button_to "Sign Out", destroy_user_session_path, method: :delete, class: "btn btn-danger ml-2" %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<h1><%= @recipe.name %></h1>

<%= form_with model: @recipe, local: true do |form| %>
  <div class="field">
    <%= form.label :public, "Public" %>
    <%= form.check_box :public %>
  </div>
  <div class="actions">
    <%= form.submit "Update Public/Private" %>
  </div>
<% end %>

<% if @recipe.public? || current_user == @recipe.user %>
  <h2>Recipe Details</h2>
  <!-- Display recipe details here -->
<% else %>
  <p>This recipe is private.</p>
<% end %>

<% if current_user == @recipe.user %>
  <%= link_to "Add New Food", new_recipe_food_path(@recipe) %>
<% end %>

<% if current_user == @recipe.user || @recipe.public? %>
  <p><%= @recipe.description %></p>
  <!-- Other recipe details -->
<% end %>

<% if current_user == @recipe.user %>
  <%= render 'foods/form', food: @food %>
<% end %>

<% if current_user && current_user == @recipe.user %>
  <%= link_to 'Edit Recipe', edit_recipe_path(@recipe) %>
<% end %>

<%= button_to 'Toggle Public/Private', toggle_public_recipe_path(@recipe), method: :patch, remote: true, id: 'toggle-button', class: @recipe.public ? 'public' : 'private' %>

<%= link_to 'Back to Recipes', recipes_path %>
